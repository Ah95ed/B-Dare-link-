# Wonder Link Game - API Documentation (ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ)

## ููุทุฉ ุงูุฎุงุฏู (Base URL)
```
https://wonder-link-backend.amhmeed31.workers.dev
```

---

## 1. ุฅุนุฏุงุฏุงุช ุงูุบุฑูุฉ

### ุงูุญุตูู ุนูู ุฅุนุฏุงุฏุงุช ุงูุบุฑูุฉ
```http
GET /rooms/settings?roomId={roomId}
```

**ุงููุนุงููุงุช**:
- `roomId` (int, required): ุฑูู ุงูุบุฑูุฉ

**ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)**:
```json
{
  "hints_enabled": true,
  "hints_per_player": 3,
  "hint_penalty_percent": 10,
  "allow_report_bad_puzzle": true,
  "auto_advance_seconds": 2,
  "shuffle_options": true,
  "show_rankings_live": true,
  "allow_skip_puzzle": false,
  "min_time_per_puzzle": 5,
  "updated_at": "2024-01-15T10:30:00"
}
```

**ุงูููุงุญุธุงุช**:
- ูุง ูุชุทูุจ ุชูุซูู
- ูุชุงุญ ููุฌููุน (ูุฏูุฑ ูุฃุนุถุงุก)

---

### ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุบุฑูุฉ
```http
POST /rooms/settings
```

**ุงูุฑุคูุณ**:
```
Authorization: Bearer {token}
Content-Type: application/json
```

**ุฌุณู ุงูุทูุจ**:
```json
{
  "roomId": 123,
  "hints_enabled": true,
  "hints_per_player": 5,
  "hint_penalty_percent": 15,
  "allow_report_bad_puzzle": true,
  "auto_advance_seconds": 3,
  "shuffle_options": true,
  "show_rankings_live": true,
  "allow_skip_puzzle": false,
  "min_time_per_puzzle": 5
}
```

**ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)**:
```json
{
  "success": true,
  "message": "Settings updated"
}
```

**ุฃุฎุทุงุก ูุญุชููุฉ**:
- `401 Unauthorized`: ุบูุฑ ูุตุฑุญ
- `403 Forbidden`: ูุณุช ูุฏูุฑ ุงูุบุฑูุฉ
- `400 Bad Request`: ูุง ูููู ุชุนุฏูู ุงูุฅุนุฏุงุฏุงุช ุจุนุฏ ุจุฏุก ุงููุนุจุฉ
- `404 Not Found`: ุงูุบุฑูุฉ ุบูุฑ ููุฌูุฏุฉ

**ุงูููุงุญุธุงุช**:
- ููุท **ูุฏูุฑ ุงูุบุฑูุฉ** (ูู ุฃูุดุฃูุง) ููููู ุงูุชุนุฏูู
- ูููู ุงูุชุนุฏูู ููุท **ูุจู ุจุฏุก ุงููุนุจุฉ** (status = 'waiting')
- ุฌููุน ุงูุญููู ุงุฎุชูุงุฑูุฉ - ูุชู ุชุญุฏูุซ ุงูููุฌูุฏ ููุท

---

## 2. ูุธุงู ุงููุณุงุนุฏุงุช

### ุทูุจ ูุณุงุนุฏุฉ
```http
POST /rooms/hint
```

**ุงูุฑุคูุณ**:
```
Authorization: Bearer {token}
Content-Type: application/json
```

**ุฌุณู ุงูุทูุจ**:
```json
{
  "roomId": 123,
  "puzzleIndex": 0
}
```

**ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)**:
```json
{
  "hint": "ูุฐุง ุงูุดูุก ุนุงุฏุฉ ูุง ูููู ุฃุฎุถุฑ ุงูููู",
  "hintsRemaining": 2
}
```

**ุฃุฎุทุงุก ูุญุชููุฉ**:
- `401 Unauthorized`: ุบูุฑ ูุตุฑุญ
- `400 Bad Request`:
  - ุงููุณุงุนุฏุงุช ูุนุทูุฉ ูู ูุฐู ุงูุบุฑูุฉ
  - ูุง ุชูุฌุฏ ูุณุงุนุฏุงุช ูุชุจููุฉ
  - ุญููู ููููุฏุฉ
- `403 Forbidden`: ุฃูุช ูุณุช ุนุถู ูู ูุฐู ุงูุบุฑูุฉ
- `404 Not Found`: ุงูุณุคุงู ุบูุฑ ููุฌูุฏ

**ุงูููุงุญุธุงุช**:
- ูู ุทูุจ ูุณุงุนุฏุฉ ูููู `hints_available` ุจููุฏุงุฑ 1
- ุงูุฎุตู ูู ุงูููุงุท ูุชู ุชุทุจููู ุนูุฏ ุฅุฑุณุงู ุงูุฅุฌุงุจุฉ
- ุจุนุฏ ุงุณุชุฎุฏุงู ูุณุงุนุฏุฉุ ุชูุฑุณู ุญุฏุซ ุฅูู ุงูุบุฑูุฉ ุงูุฃุฎุฑู

---

## 3. ุงูุฅุจูุงุบ ุนู ุงูุฃุณุฆูุฉ ุงูุณูุฆุฉ

### ุฅุฑุณุงู ุชูุฑูุฑ
```http
POST /rooms/report
```

**ุงูุฑุคูุณ**:
```
Authorization: Bearer {token}
Content-Type: application/json
```

**ุฌุณู ุงูุทูุจ**:
```json
{
  "roomId": 123,
  "puzzleIndex": 0,
  "reportType": "wrong_answer",
  "details": "ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูุฌุจ ุฃู ุชููู B ูููุณ A"
}
```

**ุฃููุงุน ุงูุชูุงุฑูุฑ ุงููุชุงุญุฉ**:
```
'bad_wording'   // ุฎุทุฃ ูู ุงูุตูุงุบุฉ
'wrong_answer'  // ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุฎุงุทุฆุฉ
'unclear'       // ุงูุณุคุงู ุบูุฑ ูุงุถุญ
'offensive'     // ูุญุชูู ูุณูุก
'duplicate'     // ุณุคุงู ููุฑุฑ
'other'         // ููุน ุขุฎุฑ
```

**ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)**:
```json
{
  "success": true,
  "message": "Report submitted successfully"
}
```

**ุฃุฎุทุงุก ูุญุชููุฉ**:
- `401 Unauthorized`: ุบูุฑ ูุตุฑุญ
- `400 Bad Request`:
  - ุงูุฅุจูุงุบุงุช ูุนุทูุฉ ูู ูุฐู ุงูุบุฑูุฉ
  - ููุน ุงูุชูุฑูุฑ ุบูุฑ ุตุญูุญ
  - ุญููู ููููุฏุฉ
- `403 Forbidden`: ุฃูุช ูุณุช ุนุถู ูู ูุฐู ุงูุบุฑูุฉ
- `404 Not Found`: ุงูุณุคุงู ุบูุฑ ููุฌูุฏ

**ุงูููุงุญุธุงุช**:
- ูู ูุณุชุฎุฏู ููููู ุงูุฅุจูุงุบ ูุฑุฉ ูุงุญุฏุฉ ุนู ูู ุณุคุงู
- ุงูุชูุงุฑูุฑ ุชูุญูุธ ูุน ูุต ุงูุณุคุงู ุงูุฃุตูู ูููุฑุฌุนูุฉ
- ูููู ูููุฏูุฑ ููุท ุนุฑุถ ุงูุชูุงุฑูุฑ

---

### ุนุฑุถ ุงูุชูุงุฑูุฑ (ูููุฏูุฑ ููุท)
```http
GET /rooms/reports?roomId={roomId}
```

**ุงูุฑุคูุณ**:
```
Authorization: Bearer {token}
```

**ุงููุนุงููุงุช**:
- `roomId` (int, required): ุฑูู ุงูุบุฑูุฉ

**ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)**:
```json
{
  "total": 3,
  "reports": [
    {
      "id": 1,
      "puzzle_index": 0,
      "report_type": "wrong_answer",
      "details": "ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุฎุงุทุฆุฉ",
      "reported_at": "2024-01-15T10:30:00",
      "username": "ุฃุญูุฏ"
    },
    {
      "id": 2,
      "puzzle_index": 1,
      "report_type": "unclear",
      "details": null,
      "reported_at": "2024-01-15T10:35:00",
      "username": "ูุงุทูุฉ"
    }
  ]
}
```

**ุฃุฎุทุงุก ูุญุชููุฉ**:
- `401 Unauthorized`: ุบูุฑ ูุตุฑุญ
- `403 Forbidden`: ูุณุช ูุฏูุฑ ุงูุบุฑูุฉ
- `404 Not Found`: ุงูุบุฑูุฉ ุบูุฑ ููุฌูุฏุฉ

**ุงูููุงุญุธุงุช**:
- ููุท **ูุฏูุฑ ุงูุบุฑูุฉ** ููููู ุฑุคูุฉ ุงูุชูุงุฑูุฑ
- ุงูุชูุงุฑูุฑ ูุฑุชุจุฉ ูู ุงูุฃุญุฏุซ ุฅูู ุงูุฃูุฏู

---

## 4. ุฃูุซูุฉ ุนูููุฉ

### ุณููุงุฑูู: ูุงุนุจ ูุทูุจ ูุณุงุนุฏุฉ

```javascript
// 1. ุทูุจ ุงููุณุงุนุฏุฉ
const response = await fetch('https://..../rooms/hint', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer ' + token,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    roomId: 123,
    puzzleIndex: 2
  })
});

const data = await response.json();
console.log('Hint:', data.hint);
console.log('Remaining:', data.hintsRemaining);

// 2. ุฅุธูุงุฑ ุงููุณุงุนุฏุฉ ููุงุนุจ
showDialog({
  title: '๐ก ุงููุณุงุนุฏุฉ',
  content: data.hint,
  message: `ุงููุณุงุนุฏุงุช ุงููุชุจููุฉ: ${data.hintsRemaining}`
});
```

### ุณููุงุฑูู: ูุงุนุจ ูุจูุบ ุนู ุณุคุงู ุณูุก

```javascript
// 1. ูุชุญ ูููุฐุฌ ุงูุฅุจูุงุบ
// 2. ุงุฎุชูุงุฑ ุงูููุน ูุงูุชูุงุตูู
// 3. ุฅุฑุณุงู ุงูุชูุฑูุฑ

const reportResponse = await fetch('https://..../rooms/report', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer ' + token,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    roomId: 123,
    puzzleIndex: 0,
    reportType: 'unclear',
    details: 'ุงูุณุคุงู ูุญุชูู ุฅุฌุงุจุชูู ุตุญูุญุชูู'
  })
});

if (reportResponse.ok) {
  showSnackbar('ุดูุฑุงู ุนูู ุชูุฑูุฑู');
}
```

### ุณููุงุฑูู: ูุฏูุฑ ูุนุฏู ุงูุฅุนุฏุงุฏุงุช

```javascript
// 1. ุฌูุจ ุงูุฅุนุฏุงุฏุงุช ุงูุญุงููุฉ
const settings = await fetch(
  'https://..../rooms/settings?roomId=123'
).then(r => r.json());

// 2. ุชุนุฏูู ุงูุฅุนุฏุงุฏุงุช
settings.hints_per_player = 5;
settings.hint_penalty_percent = 20;

// 3. ุญูุธ ุงูุฅุนุฏุงุฏุงุช
await fetch('https://..../rooms/settings', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer ' + token,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    roomId: 123,
    ...settings
  })
});
```

---

## 5. ุญุงูุงุช ุงูุฎุทุฃ ุงููุดุชุฑูุฉ

### ๐ ุฎุทุฃ 401 - ุนุฏู ุงูุชูุซูู
```json
{
  "error": "Unauthorized",
  "message": "Authentication required"
}
```
**ุงูุณุจุจ**: ูุณูุงู ุฑูุฒ ุงูุชูุซูู  
**ุงูุญู**: ุชุฃูุฏ ูู ุฅุฑุณุงู ุฑูุฒ ุตุญูุญ ูู `Authorization` header

### ๐ซ ุฎุทุฃ 403 - ููุต ุงูุตูุงุญูุงุช
```json
{
  "error": "Forbidden",
  "message": "Only room creator can modify settings"
}
```
**ุงูุณุจุจ**: ูุญุงููุฉ ุชุนุฏูู ุฅุนุฏุงุฏุงุช ุจุฏูู ูููู ูุฏูุฑ ุงูุบุฑูุฉ  
**ุงูุญู**: ููุท ูุฏูุฑ ุงูุบุฑูุฉ ููููู ุงูุชุนุฏูู

### โ ุฎุทุฃ 400 - ุทูุจ ุณูุก
```json
{
  "error": "Bad Request",
  "message": "No hints available"
}
```
**ุงูุณุจุจ**: ุงูุชูุช ุงููุณุงุนุฏุงุช ุฃู ุชู ุชุนุทูููุง  
**ุงูุญู**: ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุบุฑูุฉ

---

## 6. ูุนุฏูุงุช ุงูุญุฏูุฏ (Rate Limiting)

ุญุงููุงูุ ูุง ููุฌุฏ ุชุญุฏูุฏ ูููุนุฏูุงุช (unlimited)  
ุณูุชู ุฅุถุงูุชู ูู ุงูุฅุตุฏุงุฑุงุช ุงููุณุชูุจููุฉ

---

## 7. ููุงุท ูููุฉ

โ **ุงูุฃูุงู**:
- ุฌููุน ุงูุนูููุงุช ุชุชุทูุจ ุชูุซูู
- ููุท ุงูุฃุนุถุงุก ูููููู ุงูุฅุจูุงุบ
- ููุท ุงููุฏูุฑ ููููู ุงูุชุนุฏูู

โ **ุงูุฃุฏุงุก**:
- ุงูุงุณุชุฌุงุจุงุช ูุฎุฒูุฉ ูุคูุชุงู
- ููุงุฑุณ ุณุฑูุนุฉ ุนูู ุงูููุงุชูุญ ุงูุฃุณุงุณูุฉ

โ **ุงูุชูุงูููุฉ**:
- API RESTful ููุงุณู
- ุงุณุชุฌุงุจุงุช JSON

---

**ุขุฎุฑ ุชุญุฏูุซ**: ุงูููู  
**ุงูุฅุตุฏุงุฑ**: v2.1.0  
**ุงูุญุงูุฉ**: ูุชุฌุงูุจ
